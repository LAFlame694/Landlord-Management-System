{% extends "base.html" %}

{% load static %}

<title>My Apartments</title>
{% block extra_css %}
<!-- CSS -->
<link rel="stylesheet" href="{% static 'properties/css/apartment_list.css' %}">
{% endblock %}

{% block content %}
<div class="container">

    <!-- Header -->
    <div class="page-header">
        <h1>My Apartments</h1>

        <form method="get" class="search-form">
            <input 
                type="text"
                id="apartment-search"
                name="q"
                placeholder="Search apartment name or location..."
                value="{{ query }}"
                class="search-input"
                autocomplete="off"
            >
            <button type="submit" class="btn-search">Search</button>
        </form>

        <div class="header-actions">
            <a href="{% url 'apartment_create' %}" class="btn btn-add">Add Apartment</a>
            <a href="{% url 'landlord_dashboard' %}" class="btn btn-back">Back</a>
        </div>
    </div>

    <!-- Apartments List -->
    <div class="apartments-grid" id="apartments-grid">
        {% include 'properties/partials/apartment_cards.html' %}
    </div>

</div>

<script>
    const searchInput = document.getElementById('apartment-search');
    const apartmentsGrid = document.getElementById('apartments-grid');

    let timeout = null;

    searchInput.addEventListener('keyup', function() 
    {
        clearTimeout(timeout);
        
        timeout = setTimeout(() => {
            const query = searchInput.value;

            fetch(`?q=${encodeURIComponent(query)}&ajax=1`)
            .then(response => response.text())
            .then(html => {
                apartmentsGrid.innerHTML = html;
            });
        }, 300); // debounce (300ms)
    });
</script>

<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
{% endblock %}