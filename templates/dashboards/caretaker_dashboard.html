{% extends "base.html" %}

{% load static %}

<title>Caretaker Dashboard</title>

{% block extra_css %}
 <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <!-- CSS -->
    <link rel="stylesheet" href="{% static 'dashboards/css/caretaker_dashboard.css' %}">
{% endblock %}

{% block content %}
<div class="dashboard">

  <!-- Header -->
  <div class="dashboard-header">
      <i class="fa-solid fa-user-shield"></i>
      <h1>Caretaker Dashboard</h1>
  </div>

    <!-- Assigned Apartments -->
  <div class="section">
      <div class="section-title">
          <i class="fa-solid fa-building"></i>
          <span>Assigned Apartments</span>
      </div>

      <div class="apartments">
        {% for apartment in apartments %}
          <div class="apartment-badge">
              <i class="fa-solid fa-city"></i>

              <div class="apartment-info">
                  <span class="apartment-name">{{ apartment.name }}</span>
                  <span class="apartment-location">
                      <i class="fa-solid fa-location-dot"></i>
                      {{ apartment.location }}
                  </span>
              </div>

              <a href="{% url 'apartment_units' apartment.id %}" class="view-units-link">
                  <i class="fa-solid fa-door-open"></i>
                  View Units
              </a>
          </div>
          {% empty %}
          <div class="section">
            <div class="no-balance">
                <i class="fa-solid fa-circle-check"></i>
                <strong>No apartments assigned to you.</strong>
            </div>
        </div>
        {% endfor %}
      </div>
  </div>

  <!-- Unpaid Tenants -->
  <div class="section">
      <div class="section-title">
          <i class="fa-solid fa-triangle-exclamation"></i>
          <span>Tenants With Outstanding Balances</span>
      </div>

      <div class="tenant-grid">

          <!-- Tenant Card -->
          <div class="tenant-card">
            {% for record in unpaid_rent_records %}
              <div class="tenant-name">{{ record.tenancy.tenant.full_name }}</div>

              <div class="tenant-detail">
                  <i class="fa-solid fa-building"></i>
                  Apartment: {{ record.tenancy.unit.apartment.name }}
              </div>

              <div class="tenant-detail">
                  <i class="fa-solid fa-door-open"></i>
                  Unit: {{ record.tenancy.unit.unit_number }}
              </div>

              <div class="balance">
                  Balance: {{ record.balance }}
              </div>

              <div class="tenant-action">
                  <a href="{% url 'rent_record_list' record.tenancy.id %}">
                      <i class="fa-solid fa-file-invoice"></i>
                      View Rent Records
                  </a>
              </div>
              {% empty %}
              <div class="section">
                <div class="no-balance">
                    <i class="fa-solid fa-circle-check"></i>
                    <strong>All tenants in your assigned apartments have fully paid their rent ðŸŽ‰</strong>
                </div>
              </div>
              {% endfor %}
          </div>
      </div>
  </div>
</div>
{% endblock %}